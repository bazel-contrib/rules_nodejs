load("//packages/jasmine:index.bzl", "jasmine_node_test")
load("//packages/rollup:index.bzl", "rollup_bundle")
load(":build_defs.bzl", "simple_dir")

rollup_bundle(
    name = "chunks",
    entry_points = {
        "entry1.js": "one",
        "entry2.js": "two",
    },
    output_dir = True,
    supports_workers = True,
)

jasmine_node_test(
    name = "test",
    srcs = ["spec.js"],
    data = ["@npm//source-map"],
    deps = [":chunks"],
)

simple_dir(
    name = "entries_dir",
    files = [
        "entry1.js",
        "entry2.js",
    ],
)

rollup_bundle(
    name = "dir",
    entry_point = ":entries_dir",
    output_dir = True,
)

jasmine_node_test(
    name = "dir_test",
    srcs = ["dir.spec.js"],
    deps = [":dir"],
)
