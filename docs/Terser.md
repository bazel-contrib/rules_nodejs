---
title: Terser
layout: default
toc: true
nav: rule
---
<!-- *********************
  DO NOT EDIT THIS FILE
  It is a generated build output from Stardoc.
  Instead you must edit the .bzl file where the rules are declared,
  or possibly a markdown file next to the .bzl file
 ********************* -->
# Terser rules for Bazel

The Terser rules run the Terser JS minifier with Bazel.

Wraps the Terser CLI documented at https://github.com/terser-js/terser#command-line-usage


## Installation

Add the <code>@bazel/terser</code> npm package to your <code>devDependencies</code> in <code>package.json</code>.


## Installing with self-managed dependencies

If you didn't use the <code>yarn_install</code> or <code>npm_install</code> rule, you'll have to declare a rule in your root <code>BUILD.bazel</code> file to execute terser:

{% highlight python %}
# Create a terser rule to use in terser_minified#terser_bin
# attribute when using self-managed dependencies
nodejs_binary(
    name = "terser_bin",
    entry_point = "//:node_modules/terser/bin/uglifyjs",
    # Point bazel to your node_modules to find the entry point
    node_modules = ["//:node_modules"],
)
{% endhighlight %}



## terser_minified

Run the terser minifier.

Typical example:
{% highlight python %}
load("@npm//@bazel/terser:index.bzl", "terser_minified")

terser_minified(
    name = "out.min",
    src = "input.js",
    config_file = "terser_config.json",
)
{% endhighlight %}

Note that the <code>name</code> attribute determines what the resulting files will be called.
So the example above will output <code>out.min.js</code> and <code>out.min.js.map</code> (since <code>sourcemap</code> defaults to <code>true</code>).
If the input is a directory, then the output will also be a directory, named after the <code>name</code> attribute.


<pre>
terser_minified(<a href="#terser_minified-name">name</a>, <a href="#terser_minified-args">args</a>, <a href="#terser_minified-config_file">config_file</a>, <a href="#terser_minified-debug">debug</a>, <a href="#terser_minified-sourcemap">sourcemap</a>, <a href="#terser_minified-src">src</a>, <a href="#terser_minified-terser_bin">terser_bin</a>)
</pre>

**ATTRIBUTES**

<table class="table table-params">
  <thead>
  <tr>
    <th>Name</th>
    <th>Description</th>
    <th>Type</th>
    <th>Mandatory</th>
    <th>Default</th>
  </tr>
  </thead>
  <tbody>
            <tr id="terser_minified-name">
        <td>name</td>
        <td>
                            A unique name for this target.
                                </td>
        <td><a href="https://bazel.build/docs/build-ref.html#name">Name</a></td>
        <td>required</td>
        <td>
            
        </td>
      </tr>
            <tr id="terser_minified-args">
        <td>args</td>
        <td>
                            Additional command line arguments to pass to terser.

Terser only parses minify() args from the config file so additional arguments such as <code>--comments</code> may
be passed to the rule using this attribute. See https://github.com/terser/terser#command-line-usage for the
full list of terser CLI options.
                                </td>
        <td>List of strings</td>
        <td>optional</td>
        <td>
            []
        </td>
      </tr>
            <tr id="terser_minified-config_file">
        <td>config_file</td>
        <td>
                            A JSON file containing Terser minify() options.

This is the file you would pass to the --config-file argument in terser's CLI.
https://github.com/terser-js/terser#minify-options documents the content of the file.

Bazel will make a copy of your config file, treating it as a template.

Run bazel with <code>--subcommands</code> to see the path to the copied file.

If you use the magic strings <code>"bazel_debug"</code> or <code>"bazel_no_debug"</code>, these will be
replaced with <code>true</code> and <code>false</code> respecting the value of the <code>debug</code> attribute
or the <code>--compilation_mode=dbg</code> bazel flag.

For example

{% highlight python %}
{
    "compress": {
        "arrows": "bazel_no_debug"
    }
}
{% endhighlight %}

Will disable the <code>arrows</code> compression setting when debugging.

If <code>config_file</code> isn't supplied, Bazel will use a default config file.
                                </td>
        <td><a href="https://bazel.build/docs/build-ref.html#labels">Label</a></td>
        <td>optional</td>
        <td>
            //packages/terser:terser_config.default.json
        </td>
      </tr>
            <tr id="terser_minified-debug">
        <td>debug</td>
        <td>
                            Configure terser to produce more readable output.

Instead of setting this attribute, consider using debugging compilation mode instead
bazel build --compilation_mode=dbg //my/terser:target
so that it only affects the current build.
                                </td>
        <td>Boolean</td>
        <td>optional</td>
        <td>
            False
        </td>
      </tr>
            <tr id="terser_minified-sourcemap">
        <td>sourcemap</td>
        <td>
                            Whether to produce a .js.map output
                                </td>
        <td>Boolean</td>
        <td>optional</td>
        <td>
            True
        </td>
      </tr>
            <tr id="terser_minified-src">
        <td>src</td>
        <td>
                            File(s) to minify.

Can be a .js file, a rule producing .js files as its default output, or a rule producing a directory of .js files.

Note that you can pass multiple files to terser, which it will bundle together.
If you want to do this, you can pass a filegroup here.
                                </td>
        <td><a href="https://bazel.build/docs/build-ref.html#labels">Label</a></td>
        <td>required</td>
        <td>
            
        </td>
      </tr>
            <tr id="terser_minified-terser_bin">
        <td>terser_bin</td>
        <td>
                            An executable target that runs Terser
                                </td>
        <td><a href="https://bazel.build/docs/build-ref.html#labels">Label</a></td>
        <td>optional</td>
        <td>
            //packages/terser/bin:terser
        </td>
      </tr>
        </tbody>
</table>


