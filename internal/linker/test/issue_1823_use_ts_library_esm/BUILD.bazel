load("@npm_bazel_typescript//:index.bzl", "ts_library")
load(":ts_jest_test.bzl", "ts_jest_test")

ts_library(
    name = "lib",
    srcs = [
        "lib.ts",
    ],
    # NB: hacky hidden configuration setting so that es6_sources does not include tsickle
    #     .externs.js outputs
    runtime = "nodejs",
    deps = [
        "@npm//@types/node",
    ],
)

ts_jest_test(
    name = "test",
    srcs = [
        "lib.test.ts",
    ],
    data = [
        ".babelrc",
    ],
    jest_config = "jest.config.js",
    deps = [
        ":lib",
        "@npm//@babel/preset-env",
        "@npm//babel-jest",
    ],
)
