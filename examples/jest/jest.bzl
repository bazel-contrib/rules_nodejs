"Shows how you might create a macro for the autogeneratd Jest rule"

load("@npm//jest-cli:index.bzl", _jest_test = "jest_test")

def jest_test(name, srcs, deps, jest_config):
    "A macro around the autogenerated jest_test rule"
    jest_config_location_arg = "$(location " + jest_config + ")"
    jest_test_path_arg = ["--runTestsByPath"]
    for src in srcs:
        jest_test_path_arg = jest_test_path_arg + ["$(location " + src + ")"]

    args = [
        "--config",
        jest_config_location_arg,
        "--no-cache",
        "--no-watchman",
        "--ci",
        "--runTestsByPath",
    ] + jest_test_path_arg

    _jest_test(
        name = name,
        data = [jest_config] + srcs + deps,
        args = args,
    )
